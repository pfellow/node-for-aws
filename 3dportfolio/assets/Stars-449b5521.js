import{r as e,y as w,ak as f,n as P,V as z,j as u,R as j,al as M}from"./index-90c7a613.js";import{_ as p,a as y,C as v,P as C}from"./Preload-298be973.js";function A(a){return function(r){a.forEach(function(t){typeof t=="function"?t(r):t!=null&&(t.current=r)})}}class U extends w{constructor(r){super(r),this.onBeforeCompile=(t,s)=>{const{isWebGL2:o}=s.capabilities;t.fragmentShader=t.fragmentShader.replace("#include <output_fragment>",`
        ${o?"#include <output_fragment>":`#extension GL_OES_standard_derivatives : enable
#include <output_fragment>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <encodings_fragment>
      `)}}}const F=e.forwardRef((a,r)=>{const[t]=e.useState(()=>new U(null));return e.createElement("primitive",p({},a,{object:t,ref:r,attach:"material"}))});let c,d;const W=e.createContext(null),E=new P,S=new z,k=e.forwardRef(({children:a,range:r,limit:t=1e3,...s},o)=>{const n=e.useRef(null),[l,m]=e.useState([]),[[i,g,b]]=e.useState(()=>[new Float32Array(t*3),Float32Array.from({length:t*3},()=>1),Float32Array.from({length:t},()=>1)]);e.useEffect(()=>{n.current.geometry.attributes.position.needsUpdate=!0}),y(()=>{for(n.current.updateMatrix(),n.current.updateMatrixWorld(),E.copy(n.current.matrixWorld).invert(),n.current.geometry.drawRange.count=Math.min(t,r!==void 0?r:t,l.length),c=0;c<l.length;c++)d=l[c].current,d.getWorldPosition(S).applyMatrix4(E),S.toArray(i,c*3),n.current.geometry.attributes.position.needsUpdate=!0,d.matrixWorldNeedsUpdate=!0,d.color.toArray(g,c*3),n.current.geometry.attributes.color.needsUpdate=!0,b.set([d.size],c),n.current.geometry.attributes.size.needsUpdate=!0});const R=e.useMemo(()=>({getParent:()=>n,subscribe:x=>(m(h=>[...h,x]),()=>m(h=>h.filter(_=>_.current!==x.current)))}),[]);return e.createElement("points",p({userData:{instances:l},matrixAutoUpdate:!1,ref:A([o,n]),raycast:()=>null},s),e.createElement("bufferGeometry",null,e.createElement("bufferAttribute",{attach:"attributes-position",count:i.length/3,array:i,itemSize:3,usage:f}),e.createElement("bufferAttribute",{attach:"attributes-color",count:g.length/3,array:g,itemSize:3,usage:f}),e.createElement("bufferAttribute",{attach:"attributes-size",count:b.length,array:b,itemSize:1,usage:f})),e.createElement(W.Provider,{value:R},a))}),G=e.forwardRef(({children:a,positions:r,colors:t,sizes:s,stride:o=3,...n},l)=>{const m=e.useRef(null);return y(()=>{const i=m.current.geometry.attributes;i.position.needsUpdate=!0,t&&(i.color.needsUpdate=!0),s&&(i.size.needsUpdate=!0)}),e.createElement("points",p({ref:A([l,m])},n),e.createElement("bufferGeometry",null,e.createElement("bufferAttribute",{attach:"attributes-position",count:r.length/o,array:r,itemSize:o,usage:f}),t&&e.createElement("bufferAttribute",{attach:"attributes-color",count:t.length/o,array:t,itemSize:3,usage:f}),s&&e.createElement("bufferAttribute",{attach:"attributes-size",count:s.length/o,array:s,itemSize:1,usage:f})),a)}),D=e.forwardRef((a,r)=>a.positions instanceof Float32Array?e.createElement(G,p({},a,{ref:r})):e.createElement(k,p({},a,{ref:r}))),I=a=>{const r=j.useRef(),t=M(new Float32Array(3e3),{radius:1.1});return y((s,o)=>{r.current.rotation.x-=o/10,r.current.rotation.y-=o/15}),u.jsx("group",{rotation:[0,0,Math.PI/4],children:u.jsx(D,{ref:r,positions:t,stride:3,frustumCulled:!0,...a,children:u.jsx(F,{transparent:!0,color:"white",size:.0015,sizeAttenuation:!0,depthWrite:!1})})})},N=()=>u.jsx("div",{className:"w-full h-auto absolute inset-0 z-[-1]",children:u.jsxs(v,{camera:{position:[0,0,1]},children:[u.jsx(e.Suspense,{fallback:null,children:u.jsx(I,{})}),u.jsx(C,{all:!0})]})});export{N as default};
